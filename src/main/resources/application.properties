# ==========================================
# General Application Settings
# ==========================================
spring.application.name=ollama-demo

# ==========================================
# Ollama Connection & Model Selection
# ==========================================
spring.ai.ollama.base-url=http://localhost:11434
spring.ai.ollama.chat.options.model=granite4:3b
spring.ai.ollama.embedding.options.model=nomic-embed-text

# Google AI Studio Configuration
spring.ai.google.genai.api-key=${GOOGLE_API_KEY}
spring.ai.google.genai.chat.options.model=gemini-2.5-flash-lite
spring.ai.google.genai.chat.options.temperature=0.7

# Disable the automatic ChatClient builder to resolve bean conflicts
# we can specify which one to use manually
spring.ai.chat.client.enabled=false

# H2 Persistent Chat Memory
# Change from 'mem' to 'file' to persist data on disk
# This creates a folder called 'data' and a file 'chatdb' inside it
spring.datasource.url=jdbc:h2:file:./data/chatdb;DB_CLOSE_DELAY=-1
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=password
spring.h2.console.enabled=true

# Force Table Creation for Memory
spring.ai.chat.memory.repository.jdbc.initialize-schema=always

# ==========================================
# Performance & Stability (Fixes Hangs/Loops)
# ==========================================
# Prevents the app from hanging on startup to download models
spring.ai.ollama.init.pull-model-strategy=never

# Keeps the model in RAM for 20 minutes to avoid reloading delays
spring.ai.ollama.chat.options.keep-alive=20m

# Prevents the browser from "rotating" forever if Ollama is slow
spring.ai.ollama.chat.options.timeout=30s

# ==========================================
# AI Behavior & Output Quality
# ==========================================
# Lower temperature (0.4-0.6) makes small models more focused/less crazy
spring.ai.ollama.chat.options.temperature=0.2

# High repeat penalty stops the model from looping the same sentence
spring.ai.ollama.chat.options.repeat-penalty=1.5

# Limits response length to prevent runaway generation
spring.ai.ollama.chat.options.num-predict=200

# ==========================================
# Disable Unnecessary Modules
# ==========================================
# Disable Embeddings (Stops the mxbai-embed-large auto-pull)
spring.ai.ollama.embedding.enabled=false
spring.ai.model.embedding.enabled=false

# Disable unused OpenAI components to avoid startup warnings
spring.ai.openai.chat.enabled=false
spring.ai.openai.audio.speech.enabled=false